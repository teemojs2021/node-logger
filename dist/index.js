!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Logger=t():e.Logger=t()}(this,(function(){return function(e){var t={};function o(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}return o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";const r=o(1),n=o(2),s=o(3),i=o(4),c=o(5),a=o(6),l=o(7),p=o(8),g=o(9);o(10);e.exports=new class{constructor(){try{this.initOptions(),this.configureLog4js(),this.configureWinston(),this.configureMorgan(),this.createLog4jsLogger(),this.createWinstonLogger()}catch(e){console.error(e),this.instance=console}}initOptions(){this.options={log4js:{appenders:{system:{type:"file",filename:i.resolve("logs","system.log"),maxLogSize:1048576,backups:3},access:{type:"dateFile",filename:i.resolve("logs","access.log"),pattern:"-yyyy-MM-dd"},error:{type:"dateFile",filename:i.resolve("logs","error.log"),pattern:"-yyyy-MM-dd"},console:{type:"console"},stdout:{type:"stdout"}},categories:{default:{appenders:["access","console","stdout"],level:"INFO"},access:{appenders:["access","console","stdout"],level:"INFO"},system:{appenders:["system","console","stdout"],level:"ALL"},error:{appenders:["error","console","stdout"],level:"WARN"}},replaceConsole:!0},winston:{console:{handleExceptions:!0,json:!1,colorize:!0,timestamp:!0},file:{handleExceptions:!0,json:!1,colorize:!0,timestamp:!0,filename:i.resolve("logs","app-%DATE%.log"),datePattern:"YYYY-MM-DD",zippedArchive:!0,maxSize:"100m",maxFiles:"30d"},label:"LOGGER",level:"debug",exitOnError:!1,format:{timestamp:"YYYY-MM-DD HH:mm:ss"}},morgan:{immediate:!0,level:"combined",format:"[URL: :url] [UA: :user-agent]"}}}configureWinston(){try{if(!r.isEmpty(r.get(n,"logger.winston"))){const e=r.cloneDeep(this.options.winston),t=r.pickBy(r.get(n,"logger.winston"),e=>!r.isUndefined(e)),o=r.merge(e,t);this.options.winston=o}}catch(e){throw console.error(e),e}}createWinstonLogger(){try{const{exitOnError:e=!1,level:t="debug"}=this.options.winston,o=[this.createWinstonFileTransport(),this.createWinstonConsoleTransport()],r=a.format.combine(this.labelFormatter,this.timestampFormatter,this.printfFormatter);this.instance=a.createLogger({exitOnError:e,level:t,format:r,transports:o})}catch(e){throw console.error(e),e}}createLog4jsLogger(){try{c.configure(this.options.log4js)}catch(e){throw console.error(e),e}}createWinstonConsoleTransport(){try{return new a.transports.Console(this.options.winston.console)}catch(e){throw console.error(e),e}}createWinstonFileTransport(){try{return new a.transports.DailyRotateFile(this.options.winston.file)}catch(e){throw console.error(e),e}}get labelFormatter(){const e=this.options.winston.label;return a.format.label({label:e})}get timestampFormatter(){const e=this.options.winston.format.timestamp;return a.format.timestamp({format:e})}get printfFormatter(){const e=this.decorator.bind(this);let t=this.options.winston.format.printf;return r.isFunction(t)||(t=t=>`${e(t.level,!0)(`[${t.label}: ${r.toUpper(t.level)}]`)} ${e("grey")(` [TIME:${t.timestamp}] `)} ${e(t.level)(t.message)}`),a.format.printf(t)}configureLog4js(){try{if(!r.isEmpty(r.get(n,"logger.log4js"))){const e=r.cloneDeep(this.options.log4js),t=r.pickBy(r.get(n,"logger.log4js"),e=>!r.isUndefined(e)),o=r.merge(e,t);this.options.log4js=o}}catch(e){console.error(e)}}getLog4js(e="system"){try{return c.getLogger(e)}catch(e){return void console.error(e)}}configureMorgan(){try{if(!r.isEmpty(r.get(n,"logger.morgan"))){const e=r.cloneDeep(this.options.morgan),t=r.pickBy(r.get(n,"logger.morgan"),e=>!r.isUndefined(e)),o=r.merge(e,t);this.options.morgan=o}}catch(e){throw console.error(e),e}}decorator(e,t=!1){const o={info:"green",debug:"cyan",error:"red",warn:"yellow"}[r.toLower(e)]||"grey";return t?g.inverse[o]:g[o]}noop(...e){}info(...e){try{r.toArray(e).map(e=>this.instance.info(s.inspect(e)))}catch(e){console.error(e)}return this.noop()}error(...e){try{r.toArray(e).map(e=>this.instance.error(s.inspect(e)))}catch(e){console.error(e)}return this.noop()}warn(...e){try{r.toArray(e).map(e=>this.instance.warn(s.inspect(e)))}catch(e){console.error(e)}return this.noop()}debug(...e){try{r.toArray(e).map(e=>this.instance.debug(s.inspect(e)))}catch(e){console.error(e)}return this.noop()}write(...e){return this.info(e)}trace(e,t="system"){try{if(r.isEmpty(t))throw new TypeError("invalid category "+t);this.getLog4js(t).trace(e)}catch(e){console.error(e)}return this.noop()}getLog4jsMiddleware(e="system"){try{if(r.isEmpty(e))throw new TypeError("invalid category "+e);return c.connectLogger(this.getLog4js(e))}catch(e){return console.error(e),(e,t,o)=>o()}}getMorganMiddleware(){try{const e=this.options.morgan.format,t=this.options.morgan.immediate;return l(e,{stream:this,immediate:t})}catch(e){return console.error(e),(e,t,o)=>o()}}getWinstonMiddleware(){try{return p.create(this.instance)}catch(e){return console.error(e),(e,t,o)=>o()}}}},function(e,t){e.exports=require("lodash")},function(e,t){e.exports=require("config")},function(e,t){e.exports=require("util")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("log4js")},function(e,t){e.exports=require("winston")},function(e,t){e.exports=require("morgan")},function(e,t){e.exports=require("winston-request-logger")},function(e,t){e.exports=require("colors/safe")},function(e,t){e.exports=require("winston-daily-rotate-file")}])}));